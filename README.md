# ClassBench ルール変換プログラム
## Abstract

**ClassBench [[https://www.arl.wustl.edu/classbench/]](https://www.arl.wustl.edu/classbench/)**
で生成したルールを各提案手法の形式のルールリストとヘッダリストへ変換するプログラム群  
ClassBenchから下記の1~7の形式の中の一つを生成することができる．


## Usage

`git clone https://github.com/tanakalab/ClassBench.git`を実行することで，カレントディレクトリに _Classbench_ というディレクトリが作成される．  
作成されたディレクトリに移動し _setup.sh_ を実行することで， _db_generator_ と _trace_generator_ を使う準備が整う．  
_compile.sh_ によってそれぞれのプログラムをコンパイルをする．  
そして後は自分の生成したいルールセットに合わせて下記の1~7のどれかのスクリプトを実行する．  


#### 0. Preparation
---

`$ git clone https://github.com/tanakalab/ClassBench.git`  
`$ cd ClassBench`  
`$ sh setup.sh`  
`$ sh compile.sh`  


<br>

#### 1. ClassBenchの形式で生成
---

_classbench.sh_ の引数として生成したいフィールド，ルール数，パラメーターファイル，パケット数(１以上の整数)，ルールファイル名，パケットファイル名を入力し実行することで生成される．

**ルール例**  
> @131.10.42.40/32　95.184.130.35/32　0 : 65535　1724 : 1724　0x06/0xFF　0x1000/0x1000

**コマンド例** 
> `$ bash classbench.sh SA DA SP DP PROT FLAG 300 acl5_seed 2 Rule Header`


<br>

#### 2. ClassBenchで生成されたルールセットに評価型と評価パケット数を付与した形式で生成
---

_AddEPNToClassBench.sh_ の引数として生成したいフィールド，ルール数，パラメーターファイル，パケット数(１以上の整数)，ルールファイル名，評価型(Accept)の割合を入力し実行することで生成される．

**ルール例**
> Accept　@131.10.42.40/32　95.184.130.35/32　0 : 65535　1724 : 1724　0x06/0xFF　0x1000/0x1000　4

**コマンド例**
> `$ bash AddEPNToClassBench.sh SA DA SP DP PROT FLAG 300 acl5_seed 2 Rule 0.5`


<br>

#### 3. ClassBenchで生成されたルールセットとパケットをフィールドごとにポートはレンジルールでその他は0,1,＊形式で生成する．
---

_ZOMRangeFieldList.sh_ の引数として生成したいフィールド，ルール数，パラメーターファイル，パケット数(１以上の整数)，ルールファイル名，パケットファイル名を入力し実行することで生成される．(`-prior`オプションとファイルを指定することにより，各パケットの最優先ルールのリストを指定されたファイルに出力する事ができる．)

**ルール例**
> 0110010011011111011111\*\*\*\*\*\*\*\*\*\*　0-65535　61900-61909　00000110

**パケット例**
> 01100100110111110111111101100001　1111111111111111　1111000111001100　00000110

**コマンド例**
> `$ bash ZOMRangeFieldList.sh SA DA SP DP PROT FLAG 400 fw1_seed 1 Rule Header`  
> (`$ bash ZOMRangeFieldList.sh -prior MostPriorRuleList SA DA SP DP PROT FLAG 400 fw1_seed 1 Rule Header`)


<br>

#### 4. ClassBenchで生成されたルールセットとパケットをフィールドごとに0,1,＊形式で生成
---

_ZOMFieldList.sh_ の引数として生成したいフィールド，ルール数，パラメーターファイル，パケット数(１以上の整数)，ルールファイル名，パケットファイル名を入力し実行することで生成される．(`-prior`オプションとファイルを指定することにより，各パケットの最優先ルールのリストを指定されたファイルに出力する事ができる．)

**ルール例**
> 0010010101010010011111000011011\*　10011111110001111111001111110001　\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

**パケット例**
> 00100101010100100111110000100001　10011111110001111101111000001001　0000000000000000

**コマンド例**
> `$ bash ZOMFieldList.sh SA DA SP 1000 acl4_seed 1 Rule Header`  
> (`$ bash ZOMFieldList.sh -prior MostPriorRuleList SA DA SP 1000 acl4_seed 1 Rule Header`)


<br>

#### 5. ClassBenchで生成されたルールリストとパケットを0,1,＊形式で生成
---

_ZOMList.sh_ の引数として生成したいフィールド，ルール数，パラメーターファイル，パケット数(１以上の整数)，ルールファイル名，パケットファイル名を入力し実行することで生成される．(`-prior`オプションとファイルを指定することにより，各パケットの最優先ルールのリストを指定されたファイルに出力する事ができる．)

**ルール例**
> 01110101111011110011101001010000\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*00010011100011\*\*00000110

**パケット例**
> 100111111100011111011110000010010000000000000000000001011111010100000110

**コマンド例**
> `$ bash ZOMList.sh DA SP DP PROT 500 ipc1_seed 1 Rule Header`
> (`$ bash ZOMList.sh -prior MostPriorRuleList DA SP DP PROT 500 ipc1_seed 1 Rule Header`)


<br>

#### 6. ClassBenchで生成されたルールセットとパケットをフィールドごとに0,1,＊形式で評価パケット数と評価型を付与して生成 (ルールの末尾のフィールドは評価パケット数)
---

_EvalZOMFieldList.sh_ の引数として生成したいフィールド，ルール数，パラメーターファイル，パケット数(１以上の整数)，ルールファイル名，パケットファイル名，評価型(Accept)の割合を入力し実行することで生成される．

**ルール例**
> Accept　00000010100001010000011101111\*\*\*　10101110001100111010101\*\*\*\*\*\*\*\*\*　\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*　2

**パケット例**
> 00100101010100100111110000100001　10011111110001111101111000001001　0000000000000000

**コマンド例**
> `$ bash EvalZOMFieldList.sh SA DA SP 1000 fw3_seed 2 Rule Header 0.7`


<br>

#### 7. ClassBenchで生成されたルールセットとパケットを0,1,＊形式で評価パケット数と評価型を付与して生成 (ルールの末尾のフィールドは評価パケット数)    
---

_EvalZOMList.sh_ の引数としてルール数，フィールド数(1 ≦ n ≦ 6)，パラメーターファイル，パケット数(１以上の整数)，ルールファイル名，パケットファイル名，評価型(Accept)の割合を入力し実行することで生成される．

**ルール例**
> Deny　101000010110101011110111\*\*\*\*\*\*\*\*00100110011011000111111101010011\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*　2

**パケット例**
> 00100101010100100111110000100001100111111100011111011110000010010000000000000000

**コマンド例**
> `$ bash EvalZOMList.sh SA DA DP 100 fw5_seed 1 Rule Header 0.3`


<br>

#### 8. ClassBenchで生成されたルールセットとパケットを用いた隣接リスト形式で生成
---

_AdjacencyList.sh_ の引数として生成したいフィールド，ルール数，パラメーターファイル，パケット数(１以上の整数)，ルールファイル名，評価型(Accept)の割合を入力することで生成される．ファイル名の先頭にNET(Non Evaluation Type)と書いてある物は評価型が付与されないルールを扱う．なのでNETと書いてある場合は評価型の割合は引数として渡さない．

**隣接リスト例**
> 1  
> 0  
> 0  
> 3　4

**コマンド例**
> `$ bash AdjacencyList.sh SA DA SP DP PROT FLAG 100 acl1_seed 1 Rule 0.5`  
> `$ bash NETAdjacencyList.sh SA DA SP DP PROT FLAG 100 acl1_seed 1 Rule`


<br>

#### 9.ClassBenchで生成されたルールセットをルール番号と0,1,＊形式で，さらに隣接リスト形式で生成し，パケットをパケットの個数と0,1,＊形式で生成
---

_DistributionList.sh_ の引数として生成したいフィールド，ルール数，パラメーターファイル，パケット数(１以上の整数)，ルールファイル名，パケットファイル名，隣接リストファイル名，評価型(Accept)の割合を入力することで生成される．

**ルール例**
> 3 00000010100001010000011101111\*\*\*10101110001100111010101\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

**パケット例**
> 00100101010100100111110000100001100111111100011111011110000010010000000000000000　2

**隣接リスト例**
> 1  
> 0  
> 0  
> 3　4

**コマンド例**
> `$ bash DistributionList.sh SA DA SP DP PROT FLAG 500 ipc1_seed 1 Rule Header Adjacency 0.5`


<br>
<br>

#### 備考
---

**※使用できるパラメーターファイル**

> - acl1_seed
> - acl2_seed
> - acl3_seed
> - acl4_seed
> - acl5_seed
> - fw1_seed
> - fw2_seed
> - fw3_seed
> - fw4_seed
> - fw5_seed
> - ipc1_seed
> - ipc2_seed

**※パケット数はルール数の何倍のパケットが欲しいのかを指定する．**

**※フィールド**

> <dl>
> <dt>SA</dt>
> <dd>source address</dd>
> <dt>DA</dt>
> <dd>destination address</dd>
> <dt>SP</dt>
> <dd>source port</dd>
> <dt>DP</dt>
> <dd>destination port</dd>
> <dt>PROT</dt>
> <dd>protocol</dd>
> <dt>FLAG</dt>
> <dd>flags</dd>
> </dl>

**※フィールドを入力するときはこの順番からいらないフィールドを削った状態の物を引数とする．**
